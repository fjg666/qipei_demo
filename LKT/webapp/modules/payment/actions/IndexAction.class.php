<?phprequire_once(MO_LIB_DIR . '/DBAction.class.php');require_once(MO_LIB_DIR . '/Navbar.class.php');require_once(MO_LIB_DIR . '/LaiKeLogUtils.class.php');/** * <p>Copyright (c) 2018-2019</p> * <p>Company: www.laiketui.com</p> * @Author  sutao * @version 2.0 * @date    2018-12-12T11:06:39+0800 */class IndexAction extends Action{   public function getDefaultView()    {        $db = DBAction::getInstance();        $this->db = $db;        $request = $this->getContext()->getRequest();        $store_type = $this->getContext()->getStorage()->read('store_type');        $store_id = $this->getContext()->getStorage()->read('store_id');        // 根据插件id，查询插件信息        if($store_id){            $sql = "select * from lkt_payment where status = 0 order by sort desc";        }else{            $sql = "select * from lkt_payment where 1=1  order by sort desc";        }        $payments = $db->select($sql);        $request->setAttribute("store_id", $store_id);        $request->setAttribute("payments", $payments);        return View :: INPUT;    }    public function execute()    {        $db = DBAction::getInstance();        $this->db = $db;        $request = $this->getContext()->getRequest();        $store_type = $this->getContext()->getStorage()->read('store_type');        $store_id = $this->getContext()->getStorage()->read('store_id');        $module_list = trim($request->getParameter('module_list'));// 操作值        $log = new LaiKeLogUtils('common/payment.log');// 日志        $sql_update_listr = "update lkt_option set value = '$module_list' where store_id = '$store_id' and `group` = '$store_type' and name = 'home_page_data' ";        $res_update_list = $db->update($sql_update_listr);        if ($res_update_list) {            $log -> customerLog(__LINE__.":修改成功！\r\n");            echo json_encode(array('code' => 0, 'msg' => '修改成功！'));            exit();        } else {            $log -> customerLog(__LINE__.":修改失败：$sql_update_listr\r\n");            echo json_encode(array('code' => 0, 'msg' => '修改失败！'));            exit();        }    }    public function getRequestMethods()    {        return Request :: POST;    }}?>